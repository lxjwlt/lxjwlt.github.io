<!DOCTYPE HTML>
<!--[if IE 6]><html class="ie6 lte9 lte8 lte7 no-css3" lang="zh-cn"><![endif]-->
<!--[if IE 7]><html class="ie7 lte9 lte8 lte7 no-css3" lang="zh-cn"><![endif]-->
<!--[if IE 8]><html class="ie8 lte9 lte8 no-css3" lang="zh-cn"><![endif]-->
<!--[if IE 9]><html class="ie9 lte9 no-css3" lang="zh-cn"><![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8) | !(IE 9)  ]><!--><html lang="zh-cn" class='non-ie'><!--<![endif]-->
	<head>
		<meta charset="utf-8" />

		
			<meta name="description" content="老早就想用 github-pages 创建一个博客，于是这几天研究了一下 Jekyll，看了 Jekyll 英文文档和相关的博文，感觉英文的文档看起来很吃力，所以搭建好这个博客之后，觉得应该整理一下这方面的资料，总结安装和使用过程中遇到的问题，以备日后不时之需，也希望对大家有所帮助。" />
		

		<meta name="keywords" content="css,javascript,前端,页面制作" />
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" /><!-- 响应式网页设计：initial-scale设定初始缩放比例 maximum-scale设定允许用户缩放到的最大比例 minimum-scale设定允许用户缩放到的最小比例 值范围从0.0到10.0 user-scalable设定是否允许用户进行手动缩放 值为yes或no -->
		<title>Jekyll on Win7</title>

		<!-- page icon -->
		<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.png" />

		<!-- syntax highlighting CSS -->
		<link rel="stylesheet" type="text/css" href="/css/syntax.css" />

		<!-- Custom CSS -->
		<link rel="stylesheet" type="text/css" href="/css/main.css" />

	</head>
	<body class="post-page">
		<div class="header">
			<div class="wrap">
				<h1 class="logo">
					<a href="/">lxjwlt's blog</a>
				</h1>
				<h2 class='subname'></h2>
			</div>
		</div>

		<div class="directory" id="directory">
    <div class="directory__container" id="directory__container"></div>
    <a href="#" class="directory__button" id='expand-button'>目录</a>
</div>
<div class='main wrap'>
	<ul class="sidebar">
		<li><a class='to-index-page' href="/">ALL</a></li>
		
			<li><a class='to-others-page' href="/others.html">OTHERS[2]</a></li>
		
			<li><a class='to-front-end-page' href="/front-end.html">FRONT-END[11]</a></li>
		
	</ul>
	<div class="content post" id="post">
		<h1 class='post-title'>Jekyll on Win7</h1>
		<p class='post-date'>2013-09-14</p>
		<p>老早就想用 github-pages 创建一个博客，于是这几天研究了一下 Jekyll，看了 Jekyll 英文文档和相关的博文，感觉英文的文档看起来很吃力，所以搭建好这个博客之后，觉得应该整理一下这方面的资料，总结安装和使用过程中遇到的问题，以备日后不时之需，也希望对大家有所帮助。</p>

<p>首先推荐一篇博文——<a href="http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html">搭建一个免费的，无限流量的Blog----github Pages和Jekyll入门</a></p>

<p>上述博文介绍如何搭建一个具备基本功能的 github-pages 博客。读完通篇文章，我有个疑惑——搭建一个 github 博客不需要本地安装 Jekyll ，那安装 Jekyll 有什么用呢？后来才了解到，为了方便本地调试，而不需要每次都 push 到 github 中来查看页面效果——<em>据说 github-pages 更新有延迟</em>，所以安装本地 Jekyll 是有必要的。</p>

<p>下面会介绍到 Jekyll 的安装和基本使用，这些内容都是基于 <strong>win7 环境</strong>。</p>

<h2>安装</h2>

<p>安装 Jekyll 前需要先安装 <strong>Ruby</strong> 和 <strong>Ruby DevKit</strong>，下载地址：<a href="http://rubyinstaller.org/downloads/">http://rubyinstaller.org/downloads/</a> 。</p>

<p>安装完 Ruby 并<strong>添加进 PATH</strong> 后，解压 Devkit 安装包，进入 Devkit 解压文件根目录下，对其初始化：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">ruby dk.rb init
</code></pre></div>
<p>初始化成功后，控制台会提示<code>fix config.yml file</code>，这时用文本编辑器打开 Devkit 解压文件根目录下的<code>config.yml</code>文件，并按提示在文本底部添加 <strong>Ruby 的安装路径</strong>，如下：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text"># This configuration file contains the absolute path locations of all
# installed Rubies to be enhanced to work with the DevKit. This config
# file is generated by the &#39;ruby dk.rb init&#39; step and may be modified
# before running the &#39;ruby dk.rb install&#39; step. To include any installed
# Rubies that were not automagically discovered, simply add a line below
# the triple hyphens with the absolute path to the Ruby root directory.
#
# Example:
#
# ---
# - C:/ruby19trunk
# - C:/ruby192dev
#
---
- F:/Ruby200-x64
</code></pre></div>
<p>然后在控制台中继续输入<em>（此时路径仍是解压包根目录）</em>：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">ruby dk.rb install
</code></pre></div>
<p>如果没有出错，就可以安装Jekyll了：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">gem install jekyll
</code></pre></div>
<blockquote>
<blockquote>
<p><code>gem install</code>安装时是不会显示任何东西的，这样会让人误以为安装没有开始进行，因此可以添加<strong>大写的</strong>参数<code>V</code>，让它显示安装日志：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text"> gem install jekyll -V
</code></pre></div></blockquote>
</blockquote>

<p>接着，检测是否成功安装：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">jekyll -v
</code></pre></div>
<p>如果返回版本号，如<code>jekyll 1.2.0</code>，说明成功安装。</p>

<h2>使用</h2>

<h3>初始化</h3>

<p>Jekyll 安装成功后，在任意目录下，创建一个初始的模板：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">jekyll new myblog
</code></pre></div>
<p>这样该目录下会自动创建一个 myblog 文件夹，其中包含 Jekyll 最基本的架构：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">.
├── _config.yml
├── _layouts
|   ├── default.html
|   └── post.html
├── _posts
|   └── 2013-09-11-welcome-to-jekyll.markdown
├── css
|   ├── main.css
|   └── syntax.css
└── index.html
</code></pre></div>
<p>此时可以开启本地服务器来查看该页面，将路径指定到 myblog 目录下后运行：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">jekyll serve
</code></pre></div>
<p>如果没有出错，用浏览器打开<code>http://localhost:4000</code>就可以在本地查看该页面了。</p>

<blockquote>
<blockquote>
<p>如果控制台提示以下错误：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">  Conversion error: There was an error converting &#39;_posts/XXXX-XX-XX-XXXXX.md&#39;
</code></pre></div>
<p>该错误是由于没有安装pygments所导致的，可以选择关掉此项功能：打开<code>_config.yml</code>文件，将其中的<code>pygments</code>项设为<code>false</code>。或者参考以下几篇文章来安装pygments：</p>

<ul>
<li><a href="http://chxt6896.github.io/blog/2011/12/01/blog-pygments.html">Pygments 代码高亮</a></li>
<li><a href="http://www.aaronzh.cn/blog/install-pygments/">win7下jekyll使用pygments配置代码高亮</a></li>
<li><a href="http://dannyli.net/notes/fix-problems-of-jekyll-on-windows/">Windows 安装 Jekyll 若干问题的解决</a></li>
</ul>
</blockquote>
</blockquote>

<h3>写博文</h3>

<p>首先，博文格式有几点需要注意的：</p>

<ul>
<li>所有博文都必须以YAML front-matter形式开头。</li>
<li>博文编码必须是 &quot;以UTF-8无BOM格式编码&quot;，如果是其他格式，可以通过notepad++来进行编码转换。</li>
<li>博文必须按照<code>year-month-day-name-of-blog</code>这种格式命名，例如：<code>2013-9-14-my-first-blog</code>。</li>
</ul>

<p>所谓的 YAML front-matter ，是指以<code>---</code>开头，以<code>---</code>结尾的一种形式，用于给文章添加一些有用的信息，如类别、标签、摘要、标题等等，形式如下：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">---
layout: post
title: 我的第一篇文章
category: front-end
excerpt: &#39;这是我的第一篇博文的摘要！！&#39;
---
</code></pre></div>
<p>其中<code>layout</code>是为该博文指定一个HTML模板，模板统一放在<code>_layout</code>文件夹下，默认模板有<code>default.html</code>和<code>post.html</code>。</p>

<p>这些 YAML 格式的信息都可以用 Liquid 语法写入HTML文件中，当页面解析时，会自动获取这些值，填充进页面中，后面再深入说明。</p>

<p>注意，即使不为博文添加任何信息，也需要按 YAML 形式开头：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">---
---
</code></pre></div>
<p>写好的博文放入<code>_post</code>文件夹中，Jekyll 后台启动后会自动将它解析并添加入页面中。</p>

<blockquote>
<blockquote>
<p>如果博文中有中文编码，在运行<code>jekyll serve</code>后可能会提示如下错误：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text"> invalid byte sequence in GBK
</code></pre></div>
<p>解决方法：</p>

<p>将<code>&lt;ruby path&gt;\lib\ruby\gems\2.0.0\gems\jekyll-1.2.0\lib\jekyll\convertible.rb</code>文件中的：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text"> self.content = File.read(File.join(base, name))
</code></pre></div>
<p>改为：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text"> self.content = File.read(File.join(base, name), :encoding =&gt; &quot;utf-8&quot;)
</code></pre></div></blockquote>
</blockquote>

<h2>内部构造</h2>

<h3>模板</h3>

<p>默认模板中<code>default.html</code>构造了页面的基本结构，同时负责引入了css文件和js文件等，大致结构如下：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;&lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&#39;header&#39;&gt;&lt;/div&gt;

        {{ content }}

        &lt;div class=&#39;footer&#39;&gt;&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre></div>
<p>需要了解的是，模板中都会有<code>{{ content }}</code>，当文件套用模板时，该文件的内容是填充到<code>{{ content }}</code>中。</p>

<h3>首页</h3>

<p>默认首页为根目录下的<code>index.html</code>文件，结构如下:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">---
layout: default
title: Your New Jekyll Site
---

&lt;div id=&quot;home&quot;&gt;
  &lt;h1&gt;Blog Posts&lt;/h1&gt;
  &lt;ul class=&quot;posts&quot;&gt;
    {% for post in site.posts %}
      &lt;li&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;raquo; &lt;a href=&quot;{{ post.url }}&quot;&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
    {% endfor %}
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre></div>
<p>以上编码的作用是在首页中创建一个博文链接的列表。</p>

<p>其中<code>{% for post in site.posts %}</code>是 Liquid 语法结构，它的作用是对全部的博文做一个遍历，每次遍历到的对象用<code>post</code>来表示；</p>

<p><code>{{ post.date }}</code>是博文的分布时间，默认从博文的命名中获取，也可以在博文开头的 YAML 中随意定义，其后的<code>date_to_string</code>是一个参数，用于将该时间转换成一种简化的形式，如：<code>14 Sep 2013</code>。如果喜欢<code>2013-9-14</code>这种格式，可以使用另一种参数：<code>&quot;%Y-%m-%d&quot;</code>：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">{{ post.date | &quot;%Y-%m-%d&quot; }}
</code></pre></div>
<p><code>{{ post.url }}</code>是博文的链接。</p>

<p>任何在博文 YAML 中定义的信息都可以用<code>{{ post.XXXXX }}</code>的形式填充到页面中。</p>

<h2>github-pages</h2>

<p>用<code>jekyll new</code>语句初始化的文件可以直接在本地服务器正常调试，但如果想在 github-pages 中正常使用，还需要进行一些设置：</p>

<ol>
<li>在<code>_config.yml</code>文件中添加<code>baseurl</code>选项，并设置为<code>/project-name</code>，比方说 github 上的项目名为‘myFirstBlog’，则该选项应设置为<code>/myFirstBlog</code></li>
<li>在页面引用的所有 JS 或 CSS 文件的链接开头添加<code>{{ site.baseurl }}</code>，形如：<code>{{ site.baseurl }}/path/to/main.css</code></li>
<li>给博文链接开头添加<code>{{ site.baseurl }}</code>，如：<code>{{ site.baseurl }}{{ post.url }}</code></li>
</ol>

<p>这样，github-pages 上就能正常使用了。</p>

<p>然而这时候通过本地服务器调试页面时，却发现不能如常使用了，这是由于“设置了<code>baseurl</code>，同时改动了一些链接”所导致的。因此进行了以上的设置后，每次打开本地服务器调试页面时，都需要将<code>baseurl</code>设置为空字符：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">jekyll serve --baseurl &#39;&#39;
</code></pre></div>
<h2>实用技巧</h2>

<ul>
<li><p><code>site.categories</code>存储了博文的所有分类和该分类下所属的博文，循环遍历之：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">{% for category in site.categories %}

    &lt;li&gt;{{ category | first}}&lt;/li&gt;
    &lt;li&gt;{{ category | last | size}}&lt;/li&gt;

{% endfor %}
</code></pre></div>
<p>其中每次循环得到的<code>category</code>是一个数组，<code>category | first</code>等价于<code>category[0]</code>是该分类的名称；<code>category | last</code>等价于<code>category[1]</code>是该分类下的所有文章，用参数<code>size</code>可以获取该分类下所属文章总数。</p></li>
<li><p>通过判断类别来筛选文章：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">{% for post in site.posts %}{% if post.category == &#39;front-end&#39; %}

    &lt;a href=&#39;{{ site.baseurl }}{{ post.url }}&#39;&gt;{{ post.title }}&lt;/a&gt;

{% endif %}{% endfor %}
</code></pre></div>
<p>利用以上规则，便可以实现分类页面的效果了。</p></li>
<li><p>添加多说评论：</p>

<p>先到<a href="http://duoshuo.com/create-site/">多说</a>创建一个后台管理。</p>

<p>创建后，在后台管理选择‘工具’选项，将其中提供的通用代码复制粘贴到博文页面中即可。</p></li>
<li><p>调试页面：</p>

<p>本地调试页面时，可以在打开服务器的命令中加入<code>--watch</code>：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">jekyll serve --watch
</code></pre></div>
<p>这样，每次修改页面内容后，通过刷新页面就可以看到修改后的结果了。</p></li>
</ul>

<h2>相关链接</h2>

<h3>官方文档</h3>

<ul>
<li><a href="http://jekyllrb.com/docs/home/">Jekyll 官方文档</a></li>
<li><a href="http://wiki.shopify.com/Liquid">Liquid 语法</a></li>
</ul>

<h3>博文教程</h3>

<ul>
<li><a href="http://www.soimort.org/posts/101/">像黑客一样写博客——Jekyll入门</a></li>
<li><a href="http://blog.csdn.net/hutaoer06051/article/details/8574010">win7下安装jekyll——在github上创建自己的博客</a></li>
<li><a href="http://www.madhur.co.in/blog/2011/09/01/runningjekyllwindows.html">Running Jekyll on Windows</a></li>
<li><a href="http://yanping.me/cn/blog/2011/12/15/building-static-sites-with-jekyll/">用Jekyll构建静态网页</a></li>
<li><a href="http://beiyuu.com/github-pages/">使用Github Pages建独立博客</a></li>
<li><a href="http://kingauthur.info/2012/12/03/the-things-about-jekyll/">为Jekyll添加静态搜索</a></li>
</ul>

		<!-- Duoshuo Comment BEGIN -->
		<div class="ds-thread"></div>
		<script type="text/javascript">
			var duoshuoQuery = {short_name:"lxjwlt"};
			(function() {
				var ds = document.createElement('script');
				ds.type = 'text/javascript';ds.async = true;
				ds.src = 'http://static.duoshuo.com/embed.js';
				ds.charset = 'UTF-8';
				(document.getElementsByTagName('head')[0] 
				|| document.getElementsByTagName('body')[0]).appendChild(ds);
			})();
		</script>
		<!-- Duoshuo Comment END -->
	</div>
</div>
<script src="/scripts/post.js"></script>

		<div class="footer">
			
		</div>
		
	</body>
</html>